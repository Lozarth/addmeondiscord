<!DOCTYPE html>
<html>

<head>
    <title>Profile - Add me on Discord</title>

    <script>
        var id = window.location.hash.substr(1)
        console.log(id)

        if (id === undefined || id === '' || id === null || isNaN(id)) {
            window.location.href = '/instructions.html'
        }
    </script>
</head>

<body>
    <h1 id='countdown'>Beaming profile to Discord in 5 seconds...</h1>

    <p id='manual'>Don't have Discord installed? Use the web version <a id="manualurl" href=''>here</a>.</p>

    <a id='source' href='https://github.com/Lozarth/addmeondiscord'>Website Source</a>

    <script>
        const manualurl = document.getElementById('manualurl')

        manualurl.href = `https://discord.com/users/${id}`

        // ----- //

        const countdown = document.getElementById('countdown')

        function redirectCountdown() {
            let redirectTime = 5

            const interval = setInterval(function () {
                redirectTime--

                if (redirectTime === 0) {
                    console.log(id)
                    countdown.innerHTML = `We've beamed the profile to your Discord app.`
                    clearInterval(interval)
                    window.location.href = `discord://~/users/${id}`
                } else {
                    countdown.innerHTML = `Beaming profile to Discord in ${redirectTime} seconds...`
                }
            }, 1000)
        }

        redirectCountdown()
    </script>

    <style>
        body {
            background-color: #2f3136;
            color: #dcddde;
            font-family: 'Whitney', 'Helvetica Neue', Helvetica, Arial, sans-serif;
        }

        #countdown {
            font-size: 2em;
            text-align: center;
        }

        #manual {
            text-align: center;
        }

        #source {
            position: absolute;
            bottom: 0;
            right: 0;
            margin: 10px;
            color: #dcddde;
            text-decoration: none;
        }
    </style>
</body>

</html>
